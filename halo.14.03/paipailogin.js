halo.use(function(a){halo.add("paipailogin",function(){function b(a){var b=new RegExp("(^| )"+a+"(?:=([^;]*))?(;|$)"),c=document.cookie.match(b);return c?c[2]?unescape(c[2]):"":null}var c=navigator.userAgent.toLowerCase(),d=window.WeixinJSBridge;d||(d=c.match(/micromessenger/)?!0:!1);var e=function(){return b("wg_skey")&&b("wg_uin")||b("p_skey")&&b("p_uin")||b("skey")&&b("uin")?!0:!1},f=function(){if("paipai.com"!=window.location.host&&window.location.host.indexOf(".paipai.com")<0){var b="http://www.paipai.com/halo/paipai/wxlogin.html",c=window.location.protocol+"//"+window.location.host+window.location.pathname.replace(/\/[^\/]*$/,"")+"/afterLogin.html",d=window.location.pathname,e=d.lastIndexOf("/"),f=d.length;d=d.substring(e+1,f)}else var b=window.location.protocol+"//"+window.location.host+window.location.pathname;var g=a.request(),h=parseInt(g.wxlogin_ts)||0,i=(new Date).getTime();if(3e4>i-h)return alert("\u767b\u5f55\u5931\u8d25"),void 0;b+="?wxlogin_ts="+i,"string"==typeof d&&(b+="&s="+d),"string"==typeof c&&(b+="&ru="+encodeURIComponent(c));for(var j in g)"wxlogin_ts"!=j&&"s"!=j&&(b+="&"+j+"="+g[j]);window.location.href="http://b.paipai.com/mlogin/tws64/m/wxv2/Login?appid=1&rurl="+encodeURIComponent(b)},g=document.createElement("div");g.style.cssText="position:absolute; width:100%; height:100%; left:0; top:0; background-color:#fff; display:none;";try{document.domain="paipai.com"}catch(h){}if("paipai.com"==document.domain)var i="http://www.paipai.com/halo/paipai/afterLogin.html";else var i=window.location.protocol+"//"+window.location.host+window.location.pathname.replace(/\/[^\/]*$/,"")+"/afterLogin.html";i=encodeURIComponent(i),document.body.appendChild(g);var j=function(){};halo.afterPaipaiLogin=function(a,b){g.style.display="none",j(a,b),j=function(){}};var k=function(a){"function"==typeof a&&(j=a),g.innerHTML='<iframe frameborder="0" scrolling="no" src="http://www.paipai.com/halo/paipai/login.html?v='+(new Date).getTime()+"&ru="+i+'" width="100%" height="100%"></iframe>',g.style.display="block"},l=function(b){a.cookie.del("skey"),a.cookie.del("wg_skey"),a.cookie.del("p_skey"),a.cookie.del("uin"),a.cookie.del("wg_uin"),a.cookie.del("p_uin"),"paipai"==l.type?k(b):"wx"==l.type?f():d?f():k(b)};return l.isLogin=e,l}())});