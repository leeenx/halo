halo.use(function(a){var b=a.webkit,c=a.addClass,d=a.removeClass;a.stylesheet(".PAGE_DRAG_KEEP{"+b+"transition:"+b+"transform .3s linear;}"),a.stylesheet(".PAGE_DRAG_H_KEEP{"+b+"transition:"+b+"transform .2s linear;}"),a.stylesheet(".PAGE_DRAG_RESTORE{"+b+"transition:"+b+"transform .2s linear;}");var e=function(a,b,c){b=b.replace(/\-/g,"\\-");var d=[0];if(arguments.length>2)for(var e=2;e<arguments.length;++e)d[e-2]=arguments[e];if("none"==a||""==a)return null;var f=new RegExp(b+"\\(([^\\)]+)\\)","ig"),g=a.match(f),h=[],i=[];if(g&&g.length>0){g=g[0],h=g.replace(f,"$1").split(",");for(var e=0;e<d.length;++e)i.push(h[d[e]])}return 1==i.length?i=i[0]:c&&(i=i[c]),i};halo.add("pagedrag",function(){var f=document.documentElement.clientHeight,g=document.documentElement.clientWidth;window.addEventListener("resize",function(){f=document.documentElement.clientHeight,g=document.documentElement.clientWidth},!1);var h=function(h,i,j){!j||(j="Y"),i="X"==i.toUpperCase()?"X":"Y";var k="X"==i?"PAGE_DRAG_H_KEEP":"PAGE_DRAG_KEEP",l="PAGE_DRAG_RESTORE",m=h.scrollHeight,n=h.scrollWidth,o="X"==i?Math.ceil(n/g):Math.ceil(m/f),p=0,q=-1,r=1,s=0,t=0,u=0,v=0,w=0,x="none",y=!1,z=!1,A=function(a){if(!y){z=!1;var c=a.targetTouches||a.changedTouches,d=h.style[b+"transform"]||"";s=c[0].pageX,u=parseInt(e(d,"translate3d",0))||0,t=c[0].pageY,v=parseInt(e(d,"translate3d",1))||0,w=0,n||m||(m=h.scrollHeight,n=h.scrollWidth,o="X"==i?Math.ceil(n/g):Math.ceil(m/f),r=I(p+1),q=I(p-1)),x="none"}},B=function(c){if(c.preventDefault(),c.stopPropagation(),!y){z=!0;var d=c.targetTouches||c.changedTouches,e=d[0].pageX,f=d[0].pageY;if(j&&"none"==x){var g=e-s,k=f-t;if(Math.abs(g)==Math.abs(k))return c.preventDefault(),c.stopPropagation(),void 0;if(x=Math.abs(g)>Math.abs(k)?"X":"Y",x!=i)return a.off(h,"touchmove",B,!1),a.off(h,"release",C,!1),a.on(h,"release",D,!1),void 0}var l=1;"X"==i?(w=e-s,l=0==p&&w>0||p==o-1&&0>w?1/3:1,this.style[b+"transform"]="translate3d("+(u+w*l)+"px,0,0)"):(w=f-t,l=0==p&&w>0||p==o-1&&0>w?1/3:1,this.style[b+"transform"]="translate3d(0,"+(v+w*l)+"px,0)")}},C=function(a){y=!0,j&&a.stopPropagation();var c=(a.targetTouches||a.changedTouches,J.offset||50);Math.abs(w)<c||0>w&&p==o-1||w>0&&0==p?H():0>w?G(r):G(q)},D=function(){a.off(this,"release",D,!1),a.on(h,"touchmove",B,!1),a.on(h,"release",C,!1)},E=function(b){a.off(b,"touchstart",A,!1),a.off(b,"touchmove",B,!1),a.off(b,"touchend",C,!1)},F=function(a,b){z||G(a,b)},G=function(a,e){e="undefined"==typeof e?!1:e,e||c(h,k),h.style[b+"transform"]="X"==i?"translate3d(-"+a*g+"px,0,0)":"translate3d(0,-"+a*f+"px,0)",setTimeout(function(){d(h,k),"function"==typeof J.page_change&&J.page_change(p,a),p=a,r=p+1,q=p-1,p=I(p),r=I(r),q=I(q),y=!1,z=!1},300)},H=function(){c(h,l),h.style[b+"transform"]="X"==i?"translate3d(-"+p*g+"px,0,0)":"translate3d(0,-"+p*f+"px,0)",setTimeout(function(){d(h,l),y=!1,z=!1},200)},I=function(a){return o?a>=0?a%o:o+a%o:a};a.on(h,"touchstart",A,!1),a.on(h,"touchmove",B,!1),a.on(h,"release",C,!1),a.on(h,"forcerelease",C,!1);var J={unbind:E,move:F};return J.setAuthor=function(){var a=document.createElement("div"),b=document.createElement("div");return a.style.cssText="position: absolute; width: 100%; height: 22px; line-height: 22px; color: rgba(255,255,255,.5); font-size: 12px; font-weight: normal; top:45px; left: 0; text-align: center;",b.style.cssText="position: absolute; width: 100%; height: 22px; line-height: 22px; color: rgba(255,255,255,.5); font-size: 12px; font-weight: normal; bottom:45px; left: 0; text-align: center;",h.parentNode.insertBefore(a,h),h.parentNode.insertBefore(b,h),function(c){a.innerHTML=b.innerHTML=c||""}}(),J};return{bind:h}}())});