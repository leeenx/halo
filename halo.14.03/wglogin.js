halo.use(function(a){halo.add("wglogin",function(){function b(a){var b=new RegExp("(^| )"+a+"(?:=([^;]*))?(;|$)"),c=document.cookie.match(b);return c?c[2]?unescape(c[2]):"":null}var c=navigator.userAgent.toLowerCase(),d=window.WeixinJSBridge;d||(d=c.match(/micromessenger/)?!0:!1);var e=function(){var a=b("wg_skey")&&b("wg_uin")||b("p_skey")&&b("p_uin")||b("skey")&&b("uin")||b("wq_skey")&&b("wq_uin")?!0:!1;return b("sid")||"",a},f=function(b){if("wanggou.com"!=window.location.host&&window.location.host.indexOf(".wanggou.com")<0){var c="http://mm.wanggou.com/halo/wxlogin.html",d=window.location.protocol+"//"+window.location.host+window.location.pathname.replace(/\/[^\/]*$/,"")+"/afterLogin.html",e=window.location.pathname,f=e.lastIndexOf("/"),g=e.length;e=e.substring(f+1,g)}else var c=window.location.protocol+"//"+window.location.host+window.location.pathname;var h=a.request(),i=parseInt(h.wglogin_ts)||0,j=(new Date).getTime();if(3e4>j-i)return alert("\u767b\u5f55\u5931\u8d25"),void 0;c+="?wglogin_ts="+j,"string"==typeof e&&(c+="&s="+e),"string"==typeof d&&(c+="&ru="+encodeURIComponent(d));for(var k in h)"wglogin_ts"!=k&&"s"!=k&&(c+="&"+k+"="+h[k]);window.location.href=(b?"http://wq.jd.com/mlogin/wxv3/login_BJ":"http://party.wanggou.com/tws64/m/wxv2/Login")+"?appid=1&rurl="+encodeURIComponent(c)},g=function(){if("wanggou.com"!=window.location.host&&window.location.host.indexOf(".wanggou.com")<0){var b=window.location.protocol+"//"+window.location.host+window.location.pathname.replace(/\/[^\/]*$/,"")+"/afterLogin.html",c=window.location.pathname,d=c.lastIndexOf("/"),e=c.length;c=c.substring(d+1,e)}else var b=window.location.protocol+"//"+window.location.host+window.location.pathname;var f=a.request(),g=parseInt(f.wglogin_ts)||0,h=(new Date).getTime();return 3e4>h-g?(alert("\u767b\u5f55\u5931\u8d25"),void 0):(b+="?wglogin_ts="+h,"string"==typeof c&&(b+="&s="+c),b=encodeURIComponent(b),window.location.href="http://mm.wanggou.com/halo/login.html?v="+(new Date).getTime()+"&ru="+b,void 0)},h=function(a){a="undefined"==typeof a?!0:a,"qq"==h.type?g(a):"wx"==h.type?f(a):d?f(a):g(a)};return h.isLogin=e,h}())});